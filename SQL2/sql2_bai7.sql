DROP INDEX EMP_IDX;

DROP INDEX IDX_EMPLOYEE;
DROP INDEX IDX_CUSTOMER_STATE;

CREATE INDEX VU_INDEX_BAI1 ON employee(title);

CREATE INDEX VU_INDEX_BAI2 ON employee(first_name,last_name);

CREATE INDEX VU_INDEX_BAI3_CUST ON customer(state);
SELECT
    ai.owner,
    ai.index_name,
    aic.column_name,
    aic.column_position
FROM
    all_indexes ai
    JOIN all_ind_columns aic ON ai.owner = aic.index_owner AND ai.index_name = aic.index_name
WHERE
    ai.table_name = UPPER('customer') -- Replace with your table name
ORDER BY
    ai.index_name,
    aic.column_position;
    
    
    
    
    ----------------------------------PARTITION --------------------------------------
    
    
    
    
CREATE TABLE vu_invoices_not_partition (
    invoice_no NUMBER NOT NULL,
    invoice_date DATE NOT NULL,
    comments VARCHAR2(500)


);


BEGIN
   FOR i IN 1..1000 LOOP
      INSERT INTO VU_invoices_not_partition 
      VALUES (
         (SELECT trunc(DBMS_RANDOM.value(1, 100000)) FROM DUAL),
         (SELECT trunc(SYSDATE - DBMS_RANDOM.value(0, 3640)) FROM DUAL),
         (SELECT DBMS_RANDOM.STRING('A', 20) FROM DUAL)
      );
      COMMIT;
   END LOOP;
END;
/

CREATE TABLE vu_invoices_with_partition (
    invoice_no NUMBER NOT NULL,
    invoice_date DATE NOT NULL,
    comments VARCHAR2(500)
)
PARTITION BY RANGE (invoice_date)
(
    -- Partitions for the year 2010
    PARTITION P2010_Q1 VALUES LESS THAN (TO_DATE('01-APR-2010', 'DD-MON-YYYY')),
    PARTITION P2010_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2010', 'DD-MON-YYYY')),
    PARTITION P2010_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2010', 'DD-MON-YYYY')),
    PARTITION P2010_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2011', 'DD-MON-YYYY')),

    -- Partitions for the year 2011
    PARTITION P2011_Q1 VALUES LESS THAN (TO_DATE('01-APR-2011', 'DD-MON-YYYY')),
    PARTITION P2011_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2011', 'DD-MON-YYYY')),
    PARTITION P2011_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2011', 'DD-MON-YYYY')),
    PARTITION P2011_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2012', 'DD-MON-YYYY')),

    -- Partitions for the year 2012
    PARTITION P2012_Q1 VALUES LESS THAN (TO_DATE('01-APR-2012', 'DD-MON-YYYY')),
    PARTITION P2012_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2012', 'DD-MON-YYYY')),
    PARTITION P2012_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2012', 'DD-MON-YYYY')),
    PARTITION P2012_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2013', 'DD-MON-YYYY')),

    -- Partitions for the year 2013
    PARTITION P2013_Q1 VALUES LESS THAN (TO_DATE('01-APR-2013', 'DD-MON-YYYY')),
    PARTITION P2013_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2013', 'DD-MON-YYYY')),
    PARTITION P2013_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2013', 'DD-MON-YYYY')),
    PARTITION P2013_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2014', 'DD-MON-YYYY')),

    -- Partitions for the year 2014
    PARTITION P2014_Q1 VALUES LESS THAN (TO_DATE('01-APR-2014', 'DD-MON-YYYY')),
    PARTITION P2014_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2014', 'DD-MON-YYYY')),
    PARTITION P2014_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2014', 'DD-MON-YYYY')),
    PARTITION P2014_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2015', 'DD-MON-YYYY')),

    -- Partitions for the year 2015
    PARTITION P2015_Q1 VALUES LESS THAN (TO_DATE('01-APR-2015', 'DD-MON-YYYY')),
    PARTITION P2015_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2015', 'DD-MON-YYYY')),
    PARTITION P2015_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2015', 'DD-MON-YYYY')),
    PARTITION P2015_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2016', 'DD-MON-YYYY')),

    -- Partitions for the year 2016
    PARTITION P2016_Q1 VALUES LESS THAN (TO_DATE('01-APR-2016', 'DD-MON-YYYY')),
    PARTITION P2016_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2016', 'DD-MON-YYYY')),
    PARTITION P2016_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2016', 'DD-MON-YYYY')),
    PARTITION P2016_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2017', 'DD-MON-YYYY')),

    -- Partitions for the year 2017
    PARTITION P2017_Q1 VALUES LESS THAN (TO_DATE('01-APR-2017', 'DD-MON-YYYY')),
    PARTITION P2017_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2017', 'DD-MON-YYYY')),
    PARTITION P2017_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2017', 'DD-MON-YYYY')),
    PARTITION P2017_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2018', 'DD-MON-YYYY')),

    -- Partitions for the year 2018
    PARTITION P2018_Q1 VALUES LESS THAN (TO_DATE('01-APR-2018', 'DD-MON-YYYY')),
    PARTITION P2018_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2018', 'DD-MON-YYYY')),
    PARTITION P2018_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2018', 'DD-MON-YYYY')),
    PARTITION P2018_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2019', 'DD-MON-YYYY')),

    -- Partitions for the year 2019
    PARTITION P2019_Q1 VALUES LESS THAN (TO_DATE('01-APR-2019', 'DD-MON-YYYY')),
    PARTITION P2019_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2019', 'DD-MON-YYYY')),
    PARTITION P2019_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2019', 'DD-MON-YYYY')),
    PARTITION P2019_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2020', 'DD-MON-YYYY')),

    -- Partitions for the year 2020
    PARTITION P2020_Q1 VALUES LESS THAN (TO_DATE('01-APR-2020', 'DD-MON-YYYY')),
    PARTITION P2020_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2020', 'DD-MON-YYYY')),
    PARTITION P2020_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2020', 'DD-MON-YYYY')),
    PARTITION P2020_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2021', 'DD-MON-YYYY')),

    -- Partitions for the year 2021
    PARTITION P2021_Q1 VALUES LESS THAN (TO_DATE('01-APR-2021', 'DD-MON-YYYY')),
    PARTITION P2021_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2021', 'DD-MON-YYYY')),
    PARTITION P2021_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2021', 'DD-MON-YYYY')),
    PARTITION P2021_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2022', 'DD-MON-YYYY')),

    -- Partitions for the year 2022
    PARTITION P2022_Q1 VALUES LESS THAN (TO_DATE('01-APR-2022', 'DD-MON-YYYY')),
    PARTITION P2022_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2022', 'DD-MON-YYYY')),
    PARTITION P2022_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2022', 'DD-MON-YYYY')),
    PARTITION P2022_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2023', 'DD-MON-YYYY')),

    -- Partitions for the year 2023
    PARTITION P2023_Q1 VALUES LESS THAN (TO_DATE('01-APR-2023', 'DD-MON-YYYY')),
    PARTITION P2023_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2023', 'DD-MON-YYYY')),
    PARTITION P2023_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2023', 'DD-MON-YYYY')),
    PARTITION P2023_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2024', 'DD-MON-YYYY')),

    -- Partitions for the year 2024
    PARTITION P2024_Q1 VALUES LESS THAN (TO_DATE('01-APR-2024', 'DD-MON-YYYY')),
    PARTITION P2024_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2024', 'DD-MON-YYYY')),
    PARTITION P2024_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2024', 'DD-MON-YYYY')),
    PARTITION P2024_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2025', 'DD-MON-YYYY')),
    
    PARTITION P2025_Q1 VALUES LESS THAN (TO_DATE('01-APR-2025', 'DD-MON-YYYY')),
    PARTITION P2025_Q2 VALUES LESS THAN (TO_DATE('01-JUL-2025', 'DD-MON-YYYY')),
    PARTITION P2025_Q3 VALUES LESS THAN (TO_DATE('01-OCT-2025', 'DD-MON-YYYY')),
    PARTITION P2025_Q4 VALUES LESS THAN (TO_DATE('01-JAN-2026', 'DD-MON-YYYY'))
    
);
/

drop table vu_invoices_with_partition;

insert into vu_invoices_with_partition
select * from vu_invoices_not_partition;

select * from vu_invoices_with_partition
where invoice_date between to_date('01-APR-2023') and to_date('01-OCT-2024');

select * from vu_invoices_not_partition
where invoice_date between to_date('01-APR-2023') and to_date('01-OCT-2024');
